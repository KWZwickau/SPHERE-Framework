SELECT distinct
-- PersonId to match with all View's // tblMember
	tM.serviceTblPerson AS TblPerson_Id,
	tS.Id AS TblStudent_Id,

-- first foreign language
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 1
			and tSST.Identifier = 'FOREIGN_LANGUAGE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_ForeignLanguage1,

	(select tSS.LevelFrom
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 1
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_From_ForeignLanguage1,

	(select tSS.LevelTill
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 1
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_Till_ForeignLanguage1,

-- second foreign language
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 2
			and tSST.Identifier = 'FOREIGN_LANGUAGE'
			and tSS.tblStudent = tS.Id
			limit 0,1)= tSU.Id
	) AS TblSubject_Name_ForeignLanguage2,

	(select tSS.LevelFrom
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 2
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_From_ForeignLanguage2,

	(select tSS.LevelTill
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 2
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_Till_ForeignLanguage2,

-- third foreign language
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 3
			and tSST.Identifier = 'FOREIGN_LANGUAGE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_ForeignLanguage3,

	(select tSS.LevelFrom
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 3
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_From_ForeignLanguage3,

	(select tSS.LevelTill
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 3
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_Till_ForeignLanguage3,

-- fourth foreign language
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 4
			and tSST.Identifier = 'FOREIGN_LANGUAGE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_ForeignLanguage4,

	(select tSS.LevelFrom
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
		LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 4
		and tSST.Identifier = 'FOREIGN_LANGUAGE'
		and tSS.tblStudent = tS.Id
		limit 0,1
	) AS TblSubject_From_ForeignLanguage4,

	(select tSS.LevelTill
	from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
	LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
	LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
	where tSSR.Identifier = 4
	and tSST.Identifier = 'FOREIGN_LANGUAGE'
	and tSS.tblStudent = tS.Id
	limit 0,1
	) AS TblSubject_Till_ForeignLanguage4,

-- religion
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 1
			and tSST.Identifier = 'RELIGION'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Religion,

-- profile
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 1
			and tSST.Identifier = 'PROFILE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Profile,

-- orientation
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 1
			and tSST.Identifier = 'ORIENTATION'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Orientation,

-- elective
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 1
			and tSST.Identifier = 'ELECTIVE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Elective1,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 2
			and tSST.Identifier = 'ELECTIVE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Elective2,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 3
			and tSST.Identifier = 'ELECTIVE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Elective3,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 4
			and tSST.Identifier = 'ELECTIVE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Elective4,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 5
			and tSST.Identifier = 'ELECTIVE'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Elective5,

-- team
	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 1
			and tSST.Identifier = 'TEAM'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Team1,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 2
			and tSST.Identifier = 'TEAM'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Team2,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 3
			and tSST.Identifier = 'TEAM'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Team3,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 4
			and tSST.Identifier = 'TEAM'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Team4,

	(select
		tSU.Name
	from {{ ConsumerAcronym }}_EducationLessonSubject.tblSubject tSU
	where
		(select
			tSS.serviceTblSubject
		from {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubject tSS
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectRanking tSSR ON tSSR.Id = tSS.tblStudentSubjectRanking
			LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudentSubjectType tSST ON tSST.Id = tSS.tblStudentSubjectType
		where tSSR.Identifier = 5
			and tSST.Identifier = 'TEAM'
			and tSS.tblStudent = tS.Id
			limit 0,1) = tSU.Id
	) AS TblSubject_Name_Team5

FROM {{ ConsumerAcronym }}_PeopleGroup.tblMember tM
	LEFT JOIN {{ ConsumerAcronym }}_PeopleGroup.tblGroup tG ON tG.Id = tM.tblGroup
	LEFT JOIN {{ ConsumerAcronym }}_PeopleMeta.tblStudent tS ON tS.serviceTblPerson = tM.serviceTblPerson

WHERE tG.MetaTable = 'STUDENT'
	AND tM.EntityRemove IS NULL
	AND tG.EntityRemove IS NULL